apiVersion: v1
kind: ConfigMap
metadata:
  name: mysql-init-script
data:
  init.sql: |
    USE ecomdb;
    
    CREATE TABLE users (
        id INT AUTO_INCREMENT PRIMARY KEY,
        username VARCHAR(50) NOT NULL,
        password VARCHAR(255) NOT NULL,
        email VARCHAR(100) NOT NULL,
        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
    );

    CREATE TABLE products (
        id mediumint(8) unsigned NOT NULL auto_increment,
        Name varchar(255) default NULL,
        Price varchar(255) default NULL,
        ImageUrl varchar(255) default NULL,
        PRIMARY KEY (id)
    ) AUTO_INCREMENT=1;

    CREATE TABLE orders (
        id INT AUTO_INCREMENT PRIMARY KEY,
        user_id INT NOT NULL,
        product_id INT NOT NULL,
        quantity INT NOT NULL,
        order_date TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
        FOREIGN KEY (user_id) REFERENCES users(id),
        FOREIGN KEY (product_id) REFERENCES products(id)
    );

    INSERT INTO users (username, password, email) VALUES
    ('testuser', 'password123', 'testuser@example.com');

    INSERT INTO products (Name, Price, ImageUrl) VALUES
    ('Laptop', '100', 'c-1.png'),
    ('Drone', '200', 'c-2.png'),
    ('VR', '300', 'c-3.png'),
    ('Tablet', '50', 'c-5.png'),
    ('Watch', '90', 'c-6.png'),
    ('Phone Covers', '20', 'c-7.png'),
    ('Phone', '80', 'c-8.png'),
    ('Gaming Laptop', '150', 'c-4.png');